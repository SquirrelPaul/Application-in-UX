###多个同字段csv数据拼接代码

#导入库
import pandas as pd
import os

#修改以下3项，代码即可直接运行，目前可直接适配sensor tower的数据，如需处理其他数据，更改编码方式和格式即可
Folder_Path = r'E:\Combine'          #事先将所有待合并的数据文件放入一个文件夹中，此处填该文件夹的完整路径，注意不要包含中文。
SaveFile_Path =  r'E:\Combined'       #拼接后的文件，想保存在哪个文件路径下
SaveFile_Name = r'Combined.csv'        #拼接后文件的文件名

#得到文件夹下的所有文件名称
os.chdir(Folder_Path)
file_list= os.listdir(Folder_Path)         

#读取第一个csv中的字段名及数据，并存入文件
df = pd.read_csv(Folder_Path +'\\'+ file_list[0],encoding="UTF-16-le",delimiter="\t")   #若乱码自行更改编码encoding即可，以tab键作为分隔符
df.to_csv(SaveFile_Path+'\\'+ SaveFile_Name,encoding="UTF-16",sep="\t",index=False)   #同上

#读取剩下所有csv中的数据（不含字段名），并存入文件
for i in range(1,len(file_list)):
    df = pd.read_csv(Folder_Path + '\\' + file_list[i],encoding="UTF-16-le",delimiter="\t")     #同上
    df.to_csv(SaveFile_Path+'\\'+SaveFile_Name,encoding="UTF-16",sep="\t",index=False,header=False, mode='a+')     #同上
